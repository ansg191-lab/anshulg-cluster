apiVersion: batch/v1
kind: CronJob
metadata:
  name: pp-tree-importer
spec:
  schedule: "*/15 * * * *"
  concurrencyPolicy: Forbid
  jobTemplate:
    spec:
      template:
        spec:
          containers:
            - name: pp-tree-importer
              image: ansg191/pp-tree-importer2:main@sha256:6fe7f4b173c7d12848fed2ec433a061fd92cdd53d872b16b19dec08e039e14ab
              imagePullPolicy: IfNotPresent
              env:
                - name: GOOGLE_APPLICATION_CREDENTIALS
                  value: "/secret/credentials.json"
                - name: RUST_LOG
                  value: "info"
                - name: PP_GDRIVE_FOLDER
                  value: "1TDAKn_ud7ofTVnSQl-mjB92c3JqFvQWF"
                - name: PP_BUCKET
                  value: "pp-trees-images"
              volumeMounts:
                - mountPath: /secret
                  name: secret
              resources:
                requests:
                  cpu: 500m
                  memory: 1Gi
                limits:
                  memory: 1536Mi
          volumes:
            - name: secret
              secret:
                secretName: pptree-secrets
          restartPolicy: OnFailure
