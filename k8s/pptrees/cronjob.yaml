apiVersion: batch/v1
kind: CronJob
metadata:
  name: pp-tree-importer
spec:
  schedule: "*/5 * * * *"
  concurrencyPolicy: Forbid
  jobTemplate:
    spec:
      template:
        spec:
          containers:
            - name: pp-tree-importer
              image: ghcr.io/ansg191/pp-tree-importer2:main@sha256:af80488630077cb6cce803ce8522294b8be83faecae0e15244f753936f4bb89f
              imagePullPolicy: IfNotPresent
              env:
                - name: GOOGLE_APPLICATION_CREDENTIALS
                  value: "/secret/credentials.json"
                - name: RUST_LOG
                  value: "info"
                - name: PP_GDRIVE_FOLDER
                  value: "1TDAKn_ud7ofTVnSQl-mjB92c3JqFvQWF"
                - name: PP_BUCKET
                  value: "pp-trees-images"
              volumeMounts:
                - mountPath: /secret
                  name: secret
          volumes:
            - name: secret
              secret:
                secretName: pptree-secrets
          restartPolicy: OnFailure
          imagePullSecrets:
            - name: ghcr-registry
